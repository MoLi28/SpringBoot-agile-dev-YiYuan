<!DOCTYPE html>
<html lang="en" xmlns:v-on="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>新增货运单</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="A fully featured admin theme which can be used to build CRM, CMS, etc." name="description" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- App favicon -->
    <link rel="shortcut icon" href="/yiyuan/static/assets/images/favicon.ico">

    <!-- App css -->
    <link href="/yiyuan/static/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="/yiyuan/static/assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <link href="/yiyuan/static/assets/css/app.min.css" rel="stylesheet" type="text/css" />

</head>

<body>

<!-- Begin page -->
<div id="wrapper">

    <!-- Topbar Start -->
    <div class="navbar-custom">
        <ul class="list-unstyled topnav-menu float-right mb-0">

            <li class="dropdown d-none d-lg-block">
                <div class="dropdown-menu dropdown-menu-right">

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <img src="/yiyuan/static/assets/images/flags/spain.jpg" alt="user-image" class="mr-1" height="12"> <span class="align-middle">Spanish</span>
                    </a>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <img src="/yiyuan/static/assets/images/flags/germany.jpg" alt="user-image" class="mr-1" height="12"> <span class="align-middle">German</span>
                    </a>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <img src="/yiyuan/static/assets/images/flags/italy.jpg" alt="user-image" class="mr-1" height="12"> <span class="align-middle">Italian</span>
                    </a>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <img src="/yiyuan/static/assets/images/flags/russia.jpg" alt="user-image" class="mr-1" height="12"> <span class="align-middle">Russian</span>
                    </a>

                </div>
            </li>

            <li class="dropdown notification-list">
                <a class="nav-link dropdown-toggle waves-effect waves-light" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                    <i class="dripicons-inbox mail-icon"></i>
                    <span class="badge badge-info noti-icon-badge">20</span>
                </a>
                <div class="dropdown-menu dropdown-menu-right dropdown-lg">

                    <!-- item-->
                    <div class="dropdown-item noti-title">
                        <h5 class="m-0">
                                    <span class="float-right">
                                        <a href="" class="text-dark">
                                            <small>Clear All</small>
                                        </a>
                                    </span>20 New Messages
                        </h5>
                    </div>

                    <div class="slimscroll noti-scroll">

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon"><img src="/yiyuan/static/assets/images/users/avatar-2.jpg" class="img-fluid rounded-circle" alt="" /></div>
                            <p class="notify-details">Amily Lee<small class="text-muted">Hi, How are you? What about our next meeting?</small></p>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon">
                                <img src="/yiyuan/static/assets/images/users/avatar-3.jpg" class="img-fluid rounded-circle" alt="" /> </div>
                            <p class="notify-details">David Boos</p>
                            <p class="text-muted mb-0 user-msg">
                                <small>What about our next meeting</small>
                            </p>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon"><img src="/yiyuan/static/assets/images/users/avatar-4.jpg" class="img-fluid rounded-circle" alt="" /> </div>
                            <p class="notify-details">Christopher Palmer<small class="text-muted">Waiting for your Response...</small></p>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon">
                                <img src="/yiyuan/static/assets/images/users/avatar-5.jpg" class="img-fluid rounded-circle" alt="" /> </div>
                            <p class="notify-details">Malika Roy</p>
                            <p class="text-muted mb-0 user-msg">
                                <small>Wow that's great</small>
                            </p>
                        </a>
                    </div>

                    <!-- All-->
                    <a href="javascript:void(0);" class="dropdown-item text-center text-primary notify-item notify-all">
                        View all
                        <i class="fi-arrow-right"></i>
                    </a>

                </div>
            </li>

            <li class="dropdown notification-list">
                <a class="nav-link dropdown-toggle waves-effect waves-light" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                    <i class="dripicons-bell noti-icon"></i>
                    <span class="badge badge-danger noti-icon-badge">35</span>
                </a>
                <div class="dropdown-menu dropdown-menu-right dropdown-lg">

                    <!-- item-->
                    <div class="dropdown-item noti-title">
                        <h5 class="m-0">
                                    <span class="float-right">
                                        <a href="" class="text-dark">
                                            <small>Clear All</small>
                                        </a>
                                    </span>Notification
                        </h5>
                    </div>

                    <div class="slimscroll noti-scroll">

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon bg-info"><i class="mdi mdi-cloud-upload-outline"></i></div>
                            <p class="notify-details">Your upload has been approved<small class="text-muted">5 hours ago</small></p>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item active">
                            <div class="notify-icon bg-success"><i class="mdi mdi-map-marker-check"></i> </div>
                            <p class="notify-details">You added your Location<small class="text-muted">Just Now</small></p>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon bg-primary"><i class="mdi mdi-layers-remove"></i></div>
                            <p class="notify-details">Your item is shipped<small class="text-muted">It is a long established fact that a reader will</small></p>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon bg-purple"><i class="mdi mdi-check-bold"></i></div>
                            <p class="notify-details">Your order is placed<small class="text-muted">Dummy text of the printing and typesetting industry.</small></p>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon bg-warning">
                                <i class="mdi mdi-alert-outline"></i>
                            </div>
                            <p class="notify-details">Your Subscription Expired
                                <small class="text-muted">1 days ago</small>
                            </p>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon bg-danger">
                                <i class="mdi mdi-settings"></i>
                            </div>
                            <p class="notify-details"><b>Devid</b>, You changed your Settings
                                <small class="text-muted">5 days ago</small>
                            </p>
                        </a>
                    </div>

                    <!-- All-->
                    <a href="javascript:void(0);" class="dropdown-item text-center text-primary notify-item notify-all">
                        View all
                        <i class="fi-arrow-right"></i>
                    </a>

                </div>
            </li>

            <li class="dropdown notification-list">
               <!-- <a class="nav-link dropdown-toggle nav-user mr-0 waves-effect waves-light" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                    <img src="/yiyuan/static/assets/images/users/avatar-1.jpg" alt="user-image" class="rounded-circle">
                    <span class="pro-user-name ml-1">
                                Devid <i class="mdi mdi-chevron-down"></i>
                            </span>
                </a>-->
                <div class="dropdown-menu dropdown-menu-right profile-dropdown ">
                    <!-- item-->
                    <div class="dropdown-item noti-title">
                        <h6 class="m-0">
                            Hello, Devid !
                        </h6>
                    </div>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <i class="dripicons-user"></i>
                        <span>My Profile</span>
                    </a>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <i class="dripicons-card"></i>
                        <span>My Wallet</span>
                    </a>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <i class="dripicons-gear"></i>
                        <span>Settings</span>
                    </a>

                    <div class="dropdown-divider"></div>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <i class="dripicons-power"></i>
                        <span>Logout</span>
                    </a>

                </div>
            </li>

        </ul>

        <ul class="list-unstyled menu-left mb-0">
            <li class="float-left">
                <a href="list.html" class="logo">
                            <span class="logo-lg">
                                <img src="/yiyuan/static/assets/images/logo.png" alt="" height="25">
                            </span>
                    <span class="logo-sm">
                                <img src="/yiyuan/static/assets/images/logo-sm.png" alt="" height="24">
                            </span>
                </a>
            </li>
            <li class="float-left">
                <a class="button-menu-mobile navbar-toggle">
                    <div class="lines">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </a>
            </li>
           <!-- <li class="app-search d-none d-md-block">
                <form class="form-inline">
                    <input type="text" class="form-control" placeholder="Search…">
                    <button class="btn btn-primary-color" type="submit"><i class="fa fa-search"></i></button>
                </form>
            </li>-->
        </ul>
    </div>
    <!-- end Topbar -->

    <!-- ========== 左侧边栏 Start ========== -->
    <div class="left-side-menu">

        <div class="slimscroll-menu">

            <!--- Sidemenu -->
            <div id="sidebar-menu">

                <ul class="metismenu" id="side-menu">


                    <!--<div class="left-user">
                        <div class="user-box">
                            <div class="user-img">
                                <img src="/yiyuan/static/assets/images/users/avatar-1.jpg" alt="user-img" title="Mat Helme" class="rounded-circle img-fluid">
                                <a href="javascript:void(0);" class="user-edit"><i class="mdi mdi-pencil"></i></a>
                            </div>

                            <h5><a href="javascript: void(0);">Devid Stanberry</a> </h5>
                            <p class="text-muted mb-0"><small>Main Admin</small></p>
                        </div>
                    </div>
-->

                    <li>
                        <a href="javascript: void(0);">
                            <i class="dripicons-view-list"></i>
                            <span> 货运单 </span>
                            <span class="menu-arrow"></span>
                        </a>
                        <ul class="nav-second-level" aria-expanded="false">
                            <li>
                                <a href="form.html">新增货运单</a>
                            </li>
                            <li>
                                <a href="list.html">货物单列表</a>
                            </li>
                        </ul>
                    </li>

                </ul>

            </div>
            <!-- End Sidebar -->

            <div class="clearfix"></div>

        </div>
        <!-- Sidebar -left -->

    </div>
    <!-- 左侧边栏 End -->

    <!-- ============================================================== -->
    <!-- Start Page Content here -->
    <!-- ============================================================== -->

    <div class="content-page">
        <div class="content">

            <!-- Start Content-->
            <div class="container-fluid">

                <!-- start page title -->
                <div class="row">
                    <div class="col-12">
                        <div class="page-title-box">
                            <div class="page-title-right">
                                <ol class="breadcrumb m-0">
                                    <li class="breadcrumb-item active">Form Elements</li>
                                </ol>
                            </div>
                            <h4 class="page-title">新增货运单</h4>
                        </div>
                    </div>
                </div>
                <!-- end page title -->

                <div class="row">
                    <div class="col-12">
                        <div class="card-box">

                            <button class="btn btn-primary" id="insertQuickly">快速添加</button>
                            <form class="form-horizontal" id="basic-form">

                                <div class="form-group row">
                                    <label class="col-sm-2 col-form-label" for="example-email">名称</label>
                                    <div class="col-sm-10">
                                        <input type="text" id="form_goods_name" name="goods_name" class="form-control" placeholder="货物名称">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-sm-2 col-form-label" for="example-email">时间</label>
                                    <div class="col-sm-10">
                                        <input class="form-control" type="date" id="goodsTime" name="goodsTime">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-sm-2 col-form-label" for="example-email">出发地</label>
                                    <div class="col-sm-10">
                                        <input type="text" id="form_departure_location" name="departure_location" class="form-control" placeholder="出发地">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-sm-2 col-form-label" for="example-email">到达地</label>
                                    <div class="col-sm-10">
                                        <input type="text" id="form_arrived_location" name="arrived_location" class="form-control" placeholder="到达地">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-sm-2 col-form-label" for="example-email">规格</label>
                                    <div class="col-sm-10">
                                        <input type="text" id="form_goods_specification" name="goods_specification" class="form-control" placeholder="货物规格">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-sm-2 col-form-label">单位</label>
                                    <div class="col-sm-10">
                                        <select class="form-control" name="goods_unit" id="form_goods_unit">
                                            <option value ="1">吨</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-sm-2 col-form-label" for="example-email">数量</label>
                                    <div class="col-sm-10">
                                        <input type="number" id="form_goods_number" name="goods_number" class="form-control" placeholder="0">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-sm-2 col-form-label" for="example-email">料款/吨</label>
                                    <div class="col-sm-10">
                                        <input type="number" id="form_goods_unit_price" name="goods_unit_price" class="form-control" placeholder="0">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-sm-2 col-form-label" for="example-email">运费/吨</label>
                                    <div class="col-sm-10">
                                        <input type="number" id="form_goods_freight" name="goods_freight" class="form-control" placeholder="0">
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label class="col-sm-2 col-form-label" for="example-textarea">备注</label>
                                    <div class="col-sm-10">
                                        <textarea class="form-control" name="goods_remarks" id="example-textarea" rows="5"></textarea>
                                    </div>
                                </div>


                            </form>
                            <button class="btn btn-primary" v-on:click="ajax_insertCargoBill_FF">提交</button>


                        </div> <!-- end card-box -->
                    </div><!-- end col -->
                </div>
                <!-- end row -->








            </div> <!-- container-fluid -->

        </div> <!-- content -->

        <!-- Footer Start -->
        <footer class="footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-12 text-center">
                        2020 © Dashboard Theme By <a href="#">YiYuan</a>
                    </div>
                </div>
            </div>
        </footer>
        <!-- end Footer -->

    </div>

    <!-- ============================================================== -->
    <!-- End Page content -->
    <!-- ============================================================== -->


</div>
<!-- END wrapper -->



<!--VUE JS-->
<script src="/yiyuan/static/assets/js/vue.js"></script>
<!--Axios-->
<script src="/yiyuan/static/assets/js/axios.min.js"></script>
<!--QS-->
<!--<script src="https://cdn.bootcss.com/qs/6.7.0/qs.min.js"></script>-->
<!-- Vendor js -->
<script src="/yiyuan/static/assets/js/vendor.min.js"></script>

<script>

    //QS数据处理配置
    //var qs = Qs;

    //初始化VUE实例
    const app = new Vue({
        el: '#wrapper',     // 用于页面渲染VUE实例的元素
        data: { // 定义数据
            performDateList: []
        },
        methods:{
            //新增货运单
            ajax_insertCargoBill_FF(){
                console.log("执行货运单新增接口");

                //调用方法获取form中用户填的数据
                const date = app.form_query_FF();
                date.whetherToShip = 1;
                axios.post('/yiyuan/CargoBill/saveOrUpdateInfo',
                    date
                ).then(function (response) {
                    //请求成功响应结果response
                    console.log("↓货运单新增接口返回结果↓");
                    console.log(response);
                    console.log(response.data);
                    app.performDateList = response.data;

                    if(response.data.success === true){
                        alert("新增成功");
                        //重定向到列表页
                        window.location.replace("/yiyuan/CargoBillPage/list.html");
                    }

                }).catch(function (error) {
                    //请求异常响应结果
                    console.log(error);
                });
            },
            //表单数据获取
            form_query_FF(){
                //获取表单内的所有数据并封装
                var formData = {};
                var t = $('#basic-form').serializeArray();
                $.each(t, function() {
                    formData[this.name] = this.value;
                });
                console.log(JSON.stringify(formData));
                return formData;
            }
        }
    });

    //============ 事件监听 Strat====================
    $('#insertQuickly').on('click', function(){
        var data={
            'current':1,
            'size':1
        }
        //调用表格重载方法
        insertQuickly(data);
    });

    //============ 事件监听区End ====================
    //============ ajax接口调用方法区 Start ==================
    function insertQuickly(data) {
        axios.post('/yiyuan/CargoBill/getInfoListPage',
            data
        ).then(function (response) {
            //请求成功响应结果response
            console.log("↓货运单查询接口返回结果↓");
            console.log(response);
            console.log(response.data.data.records);
            var objdata=response.data.data.records
            injection(objdata);
        }).catch(function (error) {
            //请求异常响应结果
            console.log(error);
        });
    }
    //============ ajax接口调用方法区 End ====================

    //===== 普通方法 start=====
    function injection(objdata) {
        $("#basic-form input[name='goods_name']").val(objdata[0].goodsName);


        s = objdata[0].goodsTime.replace(/-/g,"/");
        var date = new Date(s );
        $("#basic-form input[name='goodsTime']").val(DateUtil.formatDateTime(date,"yyyy-MM-dd"));
        $("#basic-form input[name='departure_location']").val(objdata[0].departureLocation);
        $("#basic-form input[name='arrived_location']").val(objdata[0].arrivedLocation);
        $("#basic-form input[name='goods_specification']").val(objdata[0].id);
        $("#basic-form input[name='goods_unit']").val(objdata[0].goodsUnit);
        $("#basic-form input[name='goods_freight']").val(objdata[0].goodsFreight);
        $("#basic-form input[name='goods_remarks']").val(objdata[0].goodsRemarks);
        $("#basic-form input[name='goods_number']").val(objdata[0].goodsNumber);
        $("#basic-form input[name='goods_unit_price']").val(objdata[0].goodsUnitPrice);
    }
    //===== 普通方法 end=====
    
    
    //===== 页面加载后执行 start=====

    //===== 页面加载后执行 end=====

    //获取一周前和一周后时间的方法
    function getDate_FF () {
        //========== Date拓展 ========== start
        Date.prototype.Format = function (fmt) { //author: meizz
            var o = {
                "M+": this.getMonth() + 1, //月份
                "d+": this.getDate(), //日
                "H+": this.getHours(), //小时
                "m+": this.getMinutes(), //分
                "s+": this.getSeconds(), //秒
                "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                "S": this.getMilliseconds() //毫秒
            };
            if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
            for (var k in o)
                if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
            return fmt;
        }
        //========== Date拓展 ========== end

        //获取一周后的年月日
        var date1 = new Date();
        date1.setDate(date1.getDate()+7);
        var endtime = date1.Format("yyyy/MM/dd");
        //获取一周前的年月日
        var date2 = new Date();
        date2.setDate(date2.getDate()-7);
        var begtime = date2.Format("yyyy/MM/dd");

        return {"endtime":endtime,"begtime":begtime};
    };

    //解析url参数
    function GetRequest() {
        var url = location.search; //获取url中"?"符后的字串
        var theRequest = new Object();
        if (url.indexOf("?") != -1) {
            var str = url.substr(1);
            strs = str.split("&");
            for (var i = 0; i < strs.length; i++) {
                theRequest[strs[i].split("=")[0]] = decodeURI(strs[i].split("=")[1]);
            }
        }
        return theRequest;
    }



    /**
     *  时间工具类
     *  @author fei
     */
    var DateUtil={
        /**
         * 当前时间，格式 yyyy-MM-dd HH:mm:ss
         *
         * @return 当前时间的标准形式字符串
         */
        now: function() {
            return new Date().format("yyyy-MM-dd HH:mm:ss");
        },
        /**
         * 格式化日期时间
         * 格式 yyyy-MM-dd HH:mm:ss
         *
         * @param date 被格式化的日期
         * @param format 格式化 参考 {@link date_formate}
         * @return 格式化后的日期
         */
        formatDateTime: function(date,format) {
            if(format == undefined || format ==null ){
                format = "yyyy-MM-dd HH:mm:ss";
            }

            return date.format(format);
        },
        /**
         * 只支持毫秒级别时间戳，如果需要秒级别时间戳，请自行×1000
         *
         * @param timestamp 时间戳
         * @return 时间对象
         */
        date:function (timestamp) {
            return new Date(timestamp);
        }
    };

    /** 日期格式 命名参考hutool工具类 */
    date_formate = {
        /** 标准日期格式：yyyy-MM-dd */
        normDatePattern: "yyyy-MM-dd",
        /** 标准时间格式：hh:mm:ss */
        normTimePattern : "HH:mm:ss",
        /** 标准日期时间格式，精确到分：yyyy-MM-dd HH:mm */
        normDatetimeMinutePattern:"yyyy-MM-dd HH:mm",
        /** 标准日期时间格式，精确到秒：yyyy-MM-dd HH:mm:ss */
        normDatetimePattern:"yyyy-MM-dd HH:mm:ss",
        /** 标准日期时间格式，精确到毫秒：yyyy-MM-dd HH:mm:ss.SSS */
        normDatetimeMsPattern:"yyyy-MM-dd HH:mm:ss.SSS",
        /** 标准日期格式：yyyy年MM月dd日 */
        chineseDatePattern : "yyyy年MM月dd日",
        /** 标准日期格式：yyyyMMdd */
        pureDatePattern : "yyyyMMdd",
        /** 标准日期格式：HHmmss */
        pureTimePattern : "HHmmss",
        /** 标准日期格式：yyyyMMddHHmmss */
        pureDatetimePattern : "yyyyMMddHHmmss",
        /** 标准日期格式：yyyyMMddHHmmssSSS */
        pureDatetimeMsPattern : "yyyyMMddHHmmssSSS",
    };

    Date.prototype.format = function(fmt) {
        var o = {
            "M+" : this.getMonth()+1,                 //月份
            "d+" : this.getDate(),                    //日
            "H+" : this.getHours(),                   //小时
            "h+" : this.getHours(),                   //小时
            "m+" : this.getMinutes(),                 //分
            "s+" : this.getSeconds(),                 //秒
            "q+" : Math.floor((this.getMonth()+3)/3), //季度
            "S"  : this.getMilliseconds()             //毫秒
        };
        if(/(y+)/.test(fmt)) {
            fmt=fmt.replace(RegExp.$1, (this.getFullYear()+"").substr(4 - RegExp.$1.length));
        }
        for(var k in o) {
            if(new RegExp("("+ k +")").test(fmt)){
                fmt = fmt.replace(RegExp.$1, (RegExp.$1.length==1) ? (o[k]) : (("00"+ o[k]).substr((""+ o[k]).length)));
            }
        }
        return fmt;
    };



</script>




<!-- App js -->
<script src="/yiyuan/static/assets/js/app.min.js"></script>

</body>
</html>